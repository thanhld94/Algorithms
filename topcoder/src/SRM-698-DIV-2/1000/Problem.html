<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>You are given an undirected tree.
The tree has n vertices, numbered 0 through n-1.
For each valid i, there is an edge between the vertices <b>p</b>[i] and (i+1).
Each vertex i has a nonnegative integer weight <b>x</b>[i].
<br></br>
<br></br>
All nonempty connected subgraphs of our tree are called its subtrees.
The value of a subtree is the bitwise OR of the weights of its vertices.
For example, a subtree that contains vertices with weights 1, 4, and 6 has the value (1 OR 4 OR 6) = 7.
<br></br>
<br></br>
You are given the description of the tree: the int[]s <b>p</b> and <b>x</b>.
Compute and return the sum of values of all subtrees, modulo 10^9 + 7.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>SubtreeSum</td></tr><tr><td>Method:</td><td>getSum</td></tr><tr><td>Parameters:</td><td>int[], int[]</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int getSum(int[] p, int[] x)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>n will be between 2 and 50, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>p</b> will contain exactly n-1 elements.</td></tr><tr><td align="center" valign="top">-</td><td>For each i, 0 &lt;= <b>p</b>[i] &lt;= i.</td></tr><tr><td align="center" valign="top">-</td><td><b>x</b> will contain exactly n elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>x</b> will be between 0 and 1,000,000,000, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0}</pre></td></tr><tr><td><pre>{1,2}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 6</pre></td></tr><tr><td><table><tr><td colspan="2">This is a tree with two vertices and a single edge 0-1.
This tree has three subtrees:
<ul>
<li>A subtree that only contains the vertex 0.</li>
<li>A subtree that only contains the vertex 1.</li>
<li>A subtree that contains both vertices.</li>
</ul>
The values of these three subtrees are 1, 2, and 3.
Hence, the correct return value is 1+2+3 = 6.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,1}</pre></td></tr><tr><td><pre>{1,2,4}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 23</pre></td></tr><tr><td><table><tr><td colspan="2">This tree has six subtrees.
Their values are 1, 2, 4, 3, 6, and 7, respectively.
The sum of these values is 23.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,0,0,0,0,0,0,0,0,0}</pre></td></tr><tr><td><pre>{1000000,1000000,1000000,1000000,1000000,1000000,1000000,1000000,1000000,1000000,1000000}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 33999993</pre></td></tr><tr><td><table><tr><td colspan="2">This tree has 1034 subtrees.
Each of those subtrees has value 1,000,000.
Hence, the sum of values of all subtrees is 1,034,000,000.
We should return 1,034,000,000 modulo (10^9 + 7) = 33,999,993.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,0,1,0,2,2,3,0,0,2,1}</pre></td></tr><tr><td><pre>{4,5,6,7,0,8,9,5,1,2,3,6}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 6378</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>